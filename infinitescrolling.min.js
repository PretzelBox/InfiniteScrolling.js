/*
 * InfiniteScrolling.js by Joah Gerstenberg
 */
function parseQuery(){for(var a=location.search.match(/(\?|&).[^\?&]*/gi),b={},c=0;c<a.length;c++){var d=a[c].substr(1,a[c].length-1).split("=");b[d[0]]=d[1]}return b}function compileQuery(a){var b=parseQuery();return b[a.key]=a.val,"?"+$.param(b)}function loadNext(a){if(!keepGoing)return $(".async-helper").remove(),!1;var b=function(){return a?current+1:parseQuery().asyncpi?parseInt(parseQuery().asyncpi,10)+1:2}();if(loaded[b])return!1;if(a||$(".product-list").append('<div class="async-helper" style="height:1000px"></div>'),loaded[b]=!0,current=b,!a){var c=location.pathname+compileQuery({key:"asyncpi",val:b});window.history.replaceState({path:c},"",c)}$.ajax({url:location.pathname+compileQuery({key:"pi",val:b}),type:"GET",dataType:"html",success:function(a){var b=$(a).find(".product-list");if($(".product-list").find(".async-helper").remove(),b.html())$(".product-list").append(b.html()),$(document).trigger("ajaxLoad");else{keepGoing=!1;var c=location.pathname+compileQuery({key:"asyncpi",val:parseInt(parseQuery().asyncpi,10)-1});window.history.replaceState({path:c},"",c)}},error:function(a){console.log(a)}})}function loadTo(a){for(var b=0;a-current>b;b++)setTimeout(function(){loadNext(!0)},150*b)}var loaded={},current=parseInt(function(){return parseQuery().pi?parseQuery().pi:"1"}(),10),keepGoing=!0;$(window).scroll(function(){$(".product-list").offset().top+$(".product-list").height()-($(window).scrollTop()+$(window).height())<$(".product-list .row").last().height()&&loadNext()}),$(document).ready(function(){$("[id*=lblProductCountTop]").each(function(){$(this).parent().attr("style","display: none !important;")}),$("[id*=lblNumPerPageDropDownLabel]").each(function(){$(this).parent().attr("style","display: none !important;")}),$("ul.pagination").each(function(){$(this).parent().parent().attr("style","display: none !important;")}),parseQuery().asyncpi&&loadTo(parseInt(parseQuery().asyncpi,10))});